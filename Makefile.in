
CC= @CC@
CSTD= -std=gnu99
CFLAGS= $(CSTD)
MV= mv

MAINOBJ= \
	main.c.o \
	wwwfs-fuse.c \
	wwwfs-curl.c \
	wwwfs-parser.c

MDFLAGS= $(CSTD)
CFLAGS+= $(shell pkg-config fuse3 --cflags) $(shell xml2-config --cflags)
MAINLIB= $(shell pkg-config fuse3 --libs) $(shell xml2-config --libs) -lcurl

EXE= wwwfs

ALLO= $(sort $(MAINOBJ))
ALLC= $(patsubst %.c.o,%.c,$(filter %.c.o %.c,$(ALLO)))
CLEANO= $(filter %.o,$(ALLO))

default: wwwfs

all: $(EXE)

wwwfs: $(MAINOBJ)
	$(CC) $(LDFLAGS) $(CFLAGS) -o $@.tmp $^ $(MAINLIB) && $(MV) $@.tmp $@

%.c.o: %.c
	$(CC) $(CFLAGS) -c -o $@.tmp $< && $(MV) $@.tmp $@

clean:
	$(RM) $(CLEANO)
	$(RM) $(EXE)

distclean:
	$(RM) $(CLEANO)
	$(RM) $(EXE)
	$(RM) -r autom4te.cache
	$(RM) configure config.status config.log
	$(RM) Makefile

depend:
	makedepend -Y -fMakefile.in -o.c.o -- $(MDFLAGS) -- $(ALLC)

# DO NOT DELETE THIS LINE

main.c.o: wwwfs-fuse.h
wwwfs-curl.c.o: wwwfs-curl.h
wwwfs-fuse.c.o: wwwfs-curl.h wwwfs-parser.h
wwwfs-parser.c.o: wwwfs-parser.h wwwfs-curl.h
